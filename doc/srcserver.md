# Описание модулей для серверной части

## Корневая директория

* `const.conf`

    Константы и опции, используемые во всех модулях серверной части проекта.
    
    Формат соответствует инициализации hash-переменной в языке perl.
    
    Не следует править ничего в этом файле, т.к. он будет затёрт при очередном обновлении ПО.

* `redefine.conf`

    Переопределение констант и опций, описанных в `const.conf`.
    
    Этот файл нужен, чтобы локально донастраивать проект под свои нужды. Этот файл не трогается при обновлении ПО.

* `files.local.tar`

    Архив с файлами, необходимыми для установки проекта на сервере, которых нет в этом репозитории.

## Директория `html/`

Файлы, которые доступны через HTTP-сервер как есть.

## Директория `lib/`

* `Clib/`

    Различные стандартные библиотеки, взятые отсюда:
    https://github.com/cliffanet/Clib
    
    Этой директории нет в репозитории, она д.б. создана вручную в виде "мягкой ссылки".

* `CMain/`

    Контроллер HTTP-запросов, направленных, к нам через CGI/FastCGI.
    
    Ссылка для таких запросов формируется, исходя из дерева файлов-модулей.
    Например, в файле Load.pm есть функции: _root и form.
    Это обработчики ссылок: /load и /load/form

* `WebMain.pm`

    Описывает поведение обработки всех HTTP-запросов.

* `Excel/`

    Парсер XLSX-файлов от стороннего разработчика.
    
    Взято тут: https://github.com/jmcnamara/excel-reader-xlsx

* `xls2fly.pm`

    Функции парсинга исходных xlsx-файлов до момента сохранения данных во временную память.

* `flyinf.pm`

    Пост-обработка данных, сохранённых во временной памяти. В основном, нужна для удобного вывода
    данных в различных форматах.

## Директории `cgi/` и `fcgi/`

Интерфейсная часть модуля `lib/WebMain.pm` при взаимодействии с HTTP-сервером средствами `CGI` или `Fast-CGI`.

## Директория `template/`

HTML-наблоны вывода информации на разных страницах.

* `form.html`

    Форма для тестовой загрузки excel-файла в систему в ручном режиме.

* `main.html`

    Страница для мониторов взлётов.

## Директория `bin/`

* `flyevent`

    Скрипт для запуска по `cron` раз в минуту. Мониторит необходимость оповестить о готовностях к взлётам.

* `notify.telegram`

    Скрипт для оповещения через `telegram`. Используется:
    
    * При загрузке/обновлении excel-файла
    
    * Скриптом `flyevent`.

* `telegramd`

    Telegram-бот. Отвечает в чате с ботом, регистрирует участников для оповещений.

## Директория `rc.d/`

Сервисные скрипты для запуска служб проекта в различных ОС.

## Директория `manisend/`

Исходники клиента, написанные в среде Qt Creator.

* [Краткое руководство пользователя](clientman.md)

* [Описание исходного кода](srcclient.md)
